<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC 
	"-//Hibernate/Hibernate Mapping DTD 3.0//EN"
	"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">

<hibernate-mapping>
	<sql-query name="CommonLodRsLtSwQuery">
		<![CDATA[

SELECT RS.REMAIN_SINWORK_UUID,
       RS.IN_LOGISTICS_ORDER_DETAIL_UUID AS RS_IN_LOD_UUID,
       
       RS.INSTOCK_UNIT_CODE        AS UNIT_CODE,
       RS.INSTOCK_UNIT_DESC        AS UNIT_DESC,
       RS.INSTOCK_SECOND_UNIT_CODE AS SECOND_UNIT_CODE,
       RS.INSTOCK_SECOND_UNIT_DESC AS SECOND_UNIT_DESC,
       RS.INSTOCK_THIRD_UNIT_CODE  AS THIRD_UNIT_CODE,
       RS.INSTOCK_THIRD_UNIT_DESC  AS THIRD_UNIT_DESC,
       
       RS.IN_STOCK_WORK_UUID,
       RS.REMAIN_QTY,
       RS.REMAIN_SECOND_QTY,
       RS.REMAIN_THIRD_QTY,
       RS.REMAIN_GROSS_WEIGHT,
       RS.REMAIN_NET_WEIGHT,
       RS.REMAIN_VOLUME,
       RS.LOT_CODE,
       RS.BATCH_NO,
       RS.ITEM_CODE,
       RS.ITEM_SEQNO,
       RS.EXT_ITEM_CODE,
       RS.GOODS_DESC,
       RS.MARKS_NUMBER,
       RS.PACKAGE_NO,
       RS.BARCODE,
       RS.PANEL_NO,
       RS.GOODS_NATURE,
       RS.GOODS_KIND,
       RS.PRODUCTION_DATE,
       RS.OFFICE_CODE,
       RS.LENGTH,
       RS.WIDTH,
       RS.HEIGHT,
       
       LT.LOCATION_TASK_UUID,
       LT.LOGISTICS_ORDER_DETAIL_UUID,
       LT.IN_LOGISTICS_ORDER_DETAIL_UUID,
       LT.LOC_TASK_DATE,
       LT.LOC_TASK_TYPE,
       LT.LOC_TASK_DESC,
       LT.MODEL,
       LT.SPEC,
       LT.LENGTH_UNIT_CODE,
       LT.LENGTH_UNIT_DESC,
       LT.QTY AS LT_QTY,
       LT.WEIGHT_UNIT_CODE,
       LT.WEIGHT_UNIT_DESC,
       LT.VOLUME_UNIT_CODE,
       LT.VOLUME_UNIT_DESC,
       LT.LAST_LOCATION_TASK_UUID,
       LT.DANGER_CODE,
       LT.PACKAGE_TYPE,
       LT.SOURCE_LOT_CODE,
       LT.TARGET_LOT_CODE,
       LT.BARCODE AS LT_BARCODE,
       LT.WRH_WORKER,
       LT.WRH_CUST,
       LT.REMARK,
       LT.OTHER_PK_UUID,
       
       LOD.LOGISTICS_ORDER_DETAIL_UUID AS OUT_LOD_UUID,
       LOD.LOGISTICS_ORDER_NO,
       LOD.QTY AS LOD_QTY,
       LOD.CONFIRMED_QTY,
       LOD.DELIVERED_QTY
  FROM REMAIN_SINWORK RS, STOCK_WORK SW, LOCATION_TASK LT, LOGISTICS_ORDER_DETAIL LOD
 WHERE RS.IN_STOCK_WORK_UUID = SW.STOCK_WORK_UUID
   AND LT.LOCATION_TASK_UUID = SW.LOCATION_TASK_UUID
   AND LOD.OFFICE_CODE = :officeCode
   AND LOD.TRANSACTION_STATUS = 'Active'
 <<AND LOD.TRANSACTION_TYPE = :transactionType>>
 <<AND LOD.LOGISTICS_ORDER_NO = :logisticsOrderNo>>
   AND RS.OFFICE_CODE = :officeCode
   AND LT.OFFICE_CODE = :officeCode
 <<AND RS.BARCODE = :barcode>>
 <<AND (RS.BARCODE = :barcodeOrPackageNo OR RS.PACKAGE_NO = :barcodeOrPackageNo)>>
 <<AND LT.LOGISTICS_ORDER_DETAIL_UUID = :lodUuid>>
 <<AND RS.IN_LOGISTICS_ORDER_DETAIL_UUID = :inLodUuid>>
 <<AND LT.LOC_TASK_TYPE = :locTaskType>>
 <<AND LT.LOC_TASK_TYPE <> :notTaskType>>
 <<AND LT.LOGISTICS_ORDER_DETAIL_UUID IN (:lodUuids)>>
and ##CONDITIONS##

		]]>
	</sql-query>
</hibernate-mapping>
